library(ggplot2)
ggplot2
lib(ggplot2)
setwd("~/Online Education/Coursera/01.2020 Data Science with R/02.2026 Reproducible Research")
install.packages("ggplot2")
library(ggplot2)
activity <- read.csv("activity.csv", stringsAsFactors = FALSE)
activity <- read.csv("activity.csv", stringsAsFactors = FALSE)
activity$date <- as.Date(activity$date)
str(activity)
summary(activity)
steps_per_day <- aggregate(steps ~ date, data = activity, FUN = sum, na.rm = TRUE)
head(steps_per_day)
ggplot(steps_per_day, aes(x = steps)) +
geom_histogram(binwidth = 1000) +
labs(
title = "Histogram of total steps per day (NA removed)",
x = "Total steps per day",
y = "Frequency"
)
mean_steps <- mean(steps_per_day$steps)
median_steps <- median(steps_per_day$steps)
mean_steps
median_steps
avg_by_interval <- aggregate(steps ~ interval, data = activity, FUN = mean, na.rm = TRUE)
head(avg_by_interval)
plot(
avg_by_interval$interval,
avg_by_interval$steps,
type = "l",
xlab = "5-minute interval",
ylab = "Average number of steps",
main = "Average daily activity pattern"
)
max_row <- avg_by_interval[which.max(avg_by_interval$steps), ]
max_row
num_missing <- sum(is.na(activity$steps))
num_missing
interval_means <- avg_by_interval
names(interval_means)[2] <- "interval_mean"
# Merge to bring in interval mean for each row
activity_imputed <- merge(activity, interval_means, by = "interval", all.x = TRUE)
activity_imputed <- activity_imputed[order(activity_imputed$date, activity_imputed$interval), ]
# Impute: replace NA steps with interval mean
na_idx <- is.na(activity_imputed$steps)
activity_imputed$steps[na_idx] <- activity_imputed$interval_mean[na_idx]
# Clean up helper column if you want
activity_imputed$interval_mean <- NULL
# Check that no NAs remain
sum(is.na(activity_imputed$steps))
steps_per_day_imputed <- aggregate(steps ~ date, data = activity_imputed, FUN = sum)
head(steps_per_day_imputed)
ggplot(steps_per_day_imputed, aes(x = steps)) +
geom_histogram(binwidth = 1000) +
labs(
title = "Histogram of total steps per day (after imputing missing values)",
x = "Total steps per day",
y = "Frequency"
)
mean_steps_imputed <- mean(steps_per_day_imputed$steps)
median_steps_imputed <- median(steps_per_day_imputed$steps)
mean_steps_imputed
median_steps_imputed
# 1) Create weekday/weekend factor variable
activity_imputed$day_type <- ifelse(
weekdays(activity_imputed$date) %in% c("Saturday", "Sunday"),
"weekend",
"weekday"
)
activity_imputed$day_type <- factor(activity_imputed$day_type, levels = c("weekday", "weekend"))
table(activity_imputed$day_type)
avg_interval_daytype <- aggregate(steps ~ interval + day_type, data = activity_imputed, FUN = mean)
head(avg_interval_daytype)
ggplot(avg_interval_daytype, aes(x = interval, y = steps)) +
geom_line() +
facet_wrap(~ day_type, ncol = 1) +
labs(
title = "Average steps per 5-minute interval: Weekdays vs Weekends",
x = "5-minute interval",
y = "Average number of steps"
)
git init
